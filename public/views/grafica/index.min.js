/*! Godie007 - 2017-05-01 */
function generarGrafica(){var a=engine.calculateEdges(data),b=a.labels,c=a.values;$.ajax({url:"/account/grafica/cuestionario/",type:"POST",data:{area:$("#area").val()},error:function(a){console.log(a)},success:function(a){for(var d=0,e=0,f=0,g=0;g<a.ask.length;g++)for(var h=0;h<$("input[id^='radio']:checked").length;h++){var i=parseInt($("input[id^='radio']:checked").eq(h).attr("class").split("radio")[1]);if(i==g){var j=$("input[id^='radio']:checked").eq(h).val();f+=a.ask[g]["R"+j];var k=a.ask[g].RA;k=a.ask[g].RA<=k&&0!==a.ask[g].RA?a.ask[g].RA:k,k=a.ask[g].RB<=k&&0!==a.ask[g].RB?a.ask[g].RB:k,k=a.ask[g].RC<=k&&0!==a.ask[g].RC?a.ask[g].RC:k,k=a.ask[g].RD<=k&&0!==a.ask[g].RD?a.ask[g].RD:k,d+=k;var l=a.ask[g].RA;l=a.ask[g].RA>=l&&0!==a.ask[g].RA?a.ask[g].RA:l,l=a.ask[g].RB>=l&&0!==a.ask[g].RB?a.ask[g].RB:l,l=a.ask[g].RC>=l&&0!==a.ask[g].RC?a.ask[g].RC:l,l=a.ask[g].RD>=l&&0!==a.ask[g].RD?a.ask[g].RD:l,e+=l}}var m=Math.abs((f-d)/(e-d)*100);console.log("respueta "+f+" min "+d+" max "+e),console.log("Porcentaje "+m),b.push("Questionnaire"),c.push(m);var n=engine.calculateArea(c).toFixed(2);$("#areaF").text("Area Actual: "+n),$.ajax({url:"/account/grafica/nivel/",type:"POST",error:function(a){console.log(a)},success:function(a){var b=engine.calculatePercentage(n,c.length).toFixed(2),d=engine.calculateLevel(a,b);$("#procentF").text("Procentaje Actual: "+b+"%"),$("#nivelA").text("La empresa esta en "+d);var e=engine.calculateAreaTotal(c.length).toFixed(2);window.saveCaculus(e,n,d,b)}}),graficar(b,c)}})}function graficar(a,b){Chart.defaults.global.legend.display=!1,Chart.defaults.global.defaultFontColor="rgba(34,34,34, 1)";var c=$("#chartRadar"),d={labels:a,datasets:[{label:"Grafica",backgroundColor:"rgba(156,63,74,.5)",borderColor:"rgba(9,138,1,.5)",pointBackgroundColor:"rgba(156,63,74,1)",pointBorderColor:"rgba(9,138,1,.5)",pointHoverBackgroundColor:"rgba(9,138,1,.5)",pointHoverBorderColor:"rgba(9,138,1,.5)",pointBorderWidth:.5,data:b}]},e={scale:{ticks:{beginAtZero:!0,maxTicksLimit:10},pointLabels:{fontSize:12},gridLines:{color:"#999"}}};new Chart(c,{type:"radar",data:d,options:e})}var data,engine=window.engine;$(document).ready(function(){$("#tabla").hide(),$("#chartRadar").hide(),$("#resultado").hide(),$("#resultado").hide(),$("button[name='next']").attr("style","background-color: #bf0000;"),$("button[name='next']").prop("disabled",!0),$("#area").trigger("focus");var a=0,b=$(".step-progress .step-slider .step-slider-item");$('.step-content .step-content-foot button[name="prev"]').addClass("out"),$('.step-content .step-content-foot button[name="next"]').on("click",function(){var c=$(this);b.length-1<a||($('.step-content .step-content-foot button[name="prev"]').removeClass("out"),a==b.length-2&&(c.addClass("out"),c.siblings('button[name="finish"]').removeClass("out")),$(b[a]).addClass("active"),$(".step-content-body").addClass("out"),a++,1==a&&($("#formInicio").hide(),$("#formCuestionario").show(),$("#chartRadar").hide(),$("#resultado").hide(),console.log("PASO 2")),console.log(JSON.stringify(b[a])),b[a]&&$("#"+b[a].dataset.id).removeClass("out"))}),$('.step-content .step-content-foot button[name="finish"]').on("click",function(){a!=b.length&&($("#formInicio").hide(),$("#formCuestionario").hide(),$("#chartRadar").show(),$("#resultado").show(),$('button[name="prev"]').hide(),$("button[name='finish']").hide(),generarGrafica(),$(b[b.length-1]).addClass("active"),$(".step-content-body").addClass("out"),$("#stepLast").removeClass("out"),a++)}),$('.step-content .step-content-foot button[name="prev"]').on("click",function(){if(!(a-1<0)){1==a&&(console.log("PASO 1"),$("#formInicio").show(),$("#formCuestionario").hide(),$("#chartRadar").hide(),$("#resultado").hide()),2==a&&($("#formCuestionario").show(),$("#chartRadar").hide(),$("#resultado").hide()),a--;var c=$(this);a<=b.length-1&&(c.siblings('button[name="next"]').removeClass("out"),c.siblings('button[name="finish"]').addClass("out")),$(".step-content-body").addClass("out"),$("#"+b[a].dataset.id).removeClass("out"),0===a?b.removeClass("active"):b.filter(":gt("+(a-1)+")").removeClass("active"),a-1<0&&$('.step-content .step-content-foot button[name="prev"]').addClass("out")}}),$("#area").change(function(){$("#tabla").show(),"-1"===$(this).val()?($("button[name='next']").attr("style","background-color: #bf0000;"),$("button[name='next']").prop("disabled",!0),$("table.table").hide(),$("#formCuestionario").hide()):($("button[name='next']").attr("style","background-color: #00ACC2;"),$("button[name='next']").prop("disabled",!1)),"-1"!==$(this).val()&&($.ajax({url:"/account/grafica/",type:"POST",data:{area:$(this).val()},error:function(a){console.log(a)},success:function(a){data=a,0===a.length&&($("#tabla").hide(),$("button[name='next']").attr("style","background-color: #bf0000;"),$("button[name='next']").prop("disabled",!0)),$("#tabla tbody tr").remove();for(var b=0;b<a.length;b++){var c='<input id="ent'+b+'" class="input-medium"  min="'+a[b].min+'" max="'+a[b].max+'" step="1" onblur="this.value = minmax(this.value, '+a[b].min+", "+a[b].max+')" type="number"value="'+a[b].min+'">';$("#tabla tbody").append("<tr><td>"+a[b].titulo+"</td><td>"+a[b].descripcion+"</td><td>"+a[b].min+"</td><td>"+a[b].max+"</td><td>"+c+"</td><td>"+a[b].formula+"</td></tr>")}$("input:visible").eq(0).trigger("focus")}}),$.ajax({url:"/account/grafica/cuestionario/",type:"POST",data:{area:$(this).val()},error:function(a){console.log(a)},success:function(a){$("#formCuestionario div").remove();for(var b=0;b<a.ask.length;b++){var c="</div>",d='<label class="control-label">'+a.ask[b].text+"</label>",e=a.ask[b].OA.length>1?'<input type="radio" class="radio'+b+'" id="radio" class="'+b+'" value="A" name="radio"/>'+a.ask[b].OA+"</br>":"",f=a.ask[b].OB.length>1?'<input type="radio" class="radio'+b+'" id="radio" class="'+b+'" value="B" name="radio"/>'+a.ask[b].OB+"</br>":"",g=a.ask[b].OC.length>1?'<input type="radio" class="radio'+b+'" id="radio" class="'+b+'" value="C" name="radio"/>'+a.ask[b].OC+"</br>":"",h=a.ask[b].OD.length>1?'<input type="radio" class="radio'+b+'" id="radio" class="'+b+'" value="D" name="radio"/>'+a.ask[b].OD+"</br>":"";$("#formCuestionario").append('<div class="box">'+d+"<form>"+'<div class="radio">'+e+f+g+h+c+"</form>"+"<label>"+c+c),$("#formCuestionario").hide()}}}))})}),window.saveCaculus=function(a,b,c,d){console.log("Registro Guardado!"),$.ajax({url:"/account/grafica/registro/",type:"POST",data:{a_total:a,a_actual:b,nivel:c,porcentaje:d,usuario:$("#usuario").attr("class"),empresa:$("#empresa").attr("class")},error:function(a){console.log(a)},success:function(a){console.log(a)}})},window.minmax=function(a,b,c){return parseInt(a)<b||isNaN(parseInt(a))?b:parseInt(a)>c?(toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-center",preventDuplicates:!1,timeOut:"1000",onclick:function(){console.log("Toco el Mensaje")}},toastr.warning("El valor debe estar en el intervalo ["+b+","+c+"]","Importante!"),c):a};
//# sourceMappingURL=index.min.js.map